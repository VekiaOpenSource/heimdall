{# Minimum HTML5 template #}

<!DOCTYPE html>
<html lang="fr">
  <head>
    {% block head %}
      <title>{{ PAGE_TITLE }} - {{ APP_TITLE }}</title>
      {% load staticfiles %}
      <link href="{% static "css/heimdall-default.css" %}" rel="stylesheet"/>
      <link href="{% static "css/tables.css" %}" rel="stylesheet"/>
      <script src="{% static "js/jquery/jquery.min.js" %}" type="text/javascript"></script>
      <script src="{% static "js/arbor/arbor.js" %}" ></script>
      <script src="{% static "js/arbor/renderer.js" %}" ></script>
      <script src="{% static "js/arbor/graphics.js" %}" ></script>
       {% block import %}
       {% endblock %}
       
       <script>
      function closenotification($id){
      	$('#'+$id).toggle();
      }
       
       </script>
      
      <meta charset="utf-8">
      {% block head-medias %}{% endblock %}
    {% endblock %}
  </head>

  <body>
    {% block body %}

    <div class="notifications-layout">
     <!-- Notifications-->
	    {% if messages %}
	    <div class="notification" id="single">
		<span class="close-button"><img src="{% static "img/buttons/close.png"%}" onclick="closenotification('single')"/></span>
		<ul class="messages">
		  {% for message in messages %}
		  <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
		  {% endfor %}
		</ul>
	     </div>
	    {% endif %}
    </div>
      <!-- Header -->
        <header>
          {% block header %}
                      <div class="header">
                      	<div class="app">
                      		<h1 class="inline-block" ><a href="/heimdall/home">{{APP_TITLE}}</a></h1><span class="inline-block mini-title">The RSA key replicator bastion.</span>
				<!-- DESACTIVATE LOGO for the moment -->
                      		<!--<img src="{% static "images/logo.png"%}">-->
                      	</div>
                      <div class="header-actions">
                      	<div>
                      		<div>
                      			<!--messages-->
                      			<div>
		              			<div class="inline-block" style="padding-top:4px; margin-right:4px;">
		              			{% if user.is_authenticated %}
						    <span>Welcome, {{ user.username }}.</span>
							<span><a href="/heimdall/messages">
							 <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAMCAYAAABr5z2BAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIpJREFUeNpiXLVm/X8GCgATA4WABYvYAijGBhKgGKsBH4BYAKrgQFhI4EJkhUCvxiNphqlF8YIDVALsCqgGZM0LkDQ7YIQB0MaLWAzJB2F0zVC1mIGIxZAJUIxVM9ZYgCowAIUDkjCIbYCuGVcsgAx5CKQcgc6XR+ITHY3oBhGXDshNkRSnRIAAAwCEDDi73FPsUgAAAABJRU5ErkJggg==" class="GCHESSFBNL">
							{% if inbox_demands_count == None %}
							    <span>Messages: 0 </span>
							{% elif inbox_demands_count > 0 %}
							    <span>Messages:</span>
							    <span style="font-weight:bolder; font-size:11pt;">{{inbox_demands_count}}</span>
							{% else %}
							    <span>Messages: {{inbox_demands_count}}</span>
							{% endif %}
							</a></span>	   
						{% else %}
						    <span id="connect">Welcome, new user. Please log in or register.</span>
						{% endif %}
						</div>
						
						{% if user.is_authenticated %}
						<div class="inline-block">
							<form action="/heimdall/logout" method="post">
							    {% csrf_token %}
							    <input type="submit" value="Disconect →">
							</form>
						</div>
						{% endif %}
						
					</div>
                      		</div>
                      	</div>
                      	
                      	 </div>
                      	<!-- Connection form-->
                      	{% if not user.is_authenticated %}
                      	
                      	<div id="connection-form">
                      	<div class="header-connection-container">
                      	
			    <div class="connect">
				    <h2>Connexion</h2>
				    <form action="/heimdall/login" method="post" accept-charset="utf-8">
				    	{% csrf_token %}
					<label for="username">Username</label><input type="text" name="username" value="" id="username" />
					<label for="password">Password</label><input type="password" name="password" value="" id="password" />
					<p><input type="submit" value="Login →"></p>
				    </form>
				    
				    
			    </div>
			    
			    <div class="register">			    
				    <h2>Enregistrement</h2>
				    <a href="register">S'enregister</a>
			    </div>
			</div>
			</div>
			{% endif %}
                      {% endblock %}
        </header>
      <!-- End of Header -->

      <!-- Navigation -->
      <nav>
        {% block navigation %}
          <div id="tabs">
          	<ul>
          		<li><a href="/heimdall/home"><img src="{% static "img/icons/home-32x32.png" %}" title="Acceuil"/>Accueil</a></li>
          		<li><a href="/heimdall/users"><img src="{% static "img/icons/users-32x32.png" %}" title="Utilisateurs"/>Utilisateurs</a></li>
          		<li><a href="/heimdall/servers"><img src="{% static "img/icons/servers-32x32.png" %}" title="Serveurs"/>Serveurs</a></li>
          		{% if user.is_authenticated %}
          		<li><a href="/heimdall/permissions"><img src="{% static "img/icons/permissions-32x32.png" %}" title="Permissions"/>Permissions</a></li>
          		<li><a href="/heimdall/deposite"><img src="{% static "img/icons/deposite-32x32.png" %}" title="Depot"/>Dépot</a></li>
          


			{% for group in user.groups.all %}
			{% if group.name == "heimdall-admin" %}
				<!-- admin panel -->
				<hr class="separate-token"/>
				<li><a href="/heimdall/admin/permissions"><img src="{% static "img/icons/permissions-32x32.png" %}" title="Permissions"/>Permissions</a></li>
		  		<li><a href="/heimdall/admin/user"><img src="{% static "img/icons/users-32x32.png" %}" title="Depot"/>Utilisateurs</a></li>
		  		<li><a href="/heimdall/admin/manage_groups"><img src="{% static "img/icons/users-32x32.png" %}" title="Depot"/>Manage Groups</a></li>
			{% endif %}
			{% endfor %}

			{% endif %}


          	</ul>
          </div>
        {% endblock %}
      </nav>
      <!-- End of Navigation -->

      {% block maincontent %}

      <!-- Content -->
      <section id="main-content">
        {% block content %}
        
        {% endblock %}
      </section>
      {% endblock %}
      
      
      <!-- Footer -->
      <footer>
        {% block footer %}
          <p>&copy 2013 - Steeve Vandecappelle</p>
        {% endblock %}
      </footer>
      <!-- End of Footer -->
    {% endblock %}

    {% block extra-medias %}{% endblock %}
  </body>
</html>
